<!DOCTYPE html>
<html>

<head>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
  <style>
    img {
      border: 1px dotted blue;
    }
  </style>
</head>

<body>
  <input id="upload" type="file" accept=".sdo, .p24, .e24, .p09">
  <section id="0001"></section>
  <section id="cset"></section>
  <section id="hcim"></section>

  <script type="module">
    import init, { Handle } from './pkg/sdo_web.js';

    async function run() {
      await init();

      const h = new Handle(document);

      async function runFile(file) {
        const buf = await file.arrayBuffer();
        const arr = new Uint8Array(buf);
        h.do_stuff(file.name, arr);
      }

      async function runFiles(field) {
        for (const file of field.files) {
          await runFile(file);
          console.log(`Completed '${file.name}'`);
        }
      }
      
      const inputField = document.getElementById("upload");
      inputField.addEventListener('change', (event) => {
        runFiles(event.target);
      });
      runFiles(inputField);
    }

    run();
  </script>
</body>

</html>